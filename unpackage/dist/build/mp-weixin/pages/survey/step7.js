"use strict";const e=require("../../common/vendor.js");let o=null,l=null;const i={data:()=>({isPlayingExample:!1,exampleProgress:0,exampleTimeText:"0:00",videoContext:null}),onLoad(){console.log("Step7页面加载")},onReady(){this.videoContext=e.index.createVideoContext("practiceVideo",this)},onUnload(){this.clearExampleTimer(),this.pauseAllMedia()},methods:{togglePlayExample(){if(console.log("点击示例播放按钮，当前状态:",this.isPlayingExample),this.isPlayingExample&&o)return console.log("暂停示例音频"),o.pause(),this.isPlayingExample=!1,void this.clearExampleTimer();if(o)return console.log("继续播放已存在的示例音频"),o.play(),this.isPlayingExample=!0,void this.startExampleTimer();try{console.log("创建新示例音频实例"),o=e.wx$1.createInnerAudioContext(),o.src="/static/_finalfinal.mp3",o.onError((o=>{console.error("示例音频播放错误:",o),this.isPlayingExample=!1,this.clearExampleTimer(),e.index.showToast({title:"音频播放失败",icon:"none"})})),o.onEnded((()=>{console.log("示例音频播放结束"),this.isPlayingExample=!1,this.clearExampleTimer(),this.exampleProgress=100,this.exampleTimeText="0:23"})),o.play(),this.isPlayingExample=!0,this.startExampleTimer()}catch(l){console.error("示例音频播放失败:",l),this.isPlayingExample=!1,e.index.showToast({title:"音频播放失败",icon:"none"})}},startExampleTimer(){this.clearExampleTimer(),l=setInterval((()=>{if(o&&"number"==typeof o.currentTime){const e=o.currentTime;this.exampleProgress=Math.floor(e/23*100);const l=Math.floor(e%60);this.exampleTimeText=`0:${l.toString().padStart(2,"0")}`,console.log(`更新示例进度: ${this.exampleProgress}%, 时间: ${this.exampleTimeText}`)}}),1e3)},clearExampleTimer(){l&&(clearInterval(l),l=null)},onExampleSliderChange(l){if(o)try{const e=l.detail.value;console.log("示例滑块值:",e);const i=e/100*23;console.log("跳转到位置:",i,"秒"),o.seek(i);const a=Math.floor(i%60);this.exampleTimeText=`0:${a.toString().padStart(2,"0")}`,this.isPlayingExample||(console.log("从新位置开始播放示例"),o.play(),this.isPlayingExample=!0,this.startExampleTimer())}catch(i){console.error("跳转示例播放失败:",i),e.index.showToast({title:"跳转失败",icon:"none"})}else console.log("示例音频未初始化，无法跳转")},onVideoPlay(){console.log("视频开始播放"),o&&this.isPlayingExample&&(o.pause(),this.isPlayingExample=!1,this.clearExampleTimer())},onVideoPause(){console.log("视频暂停播放")},onVideoEnd(){console.log("视频播放结束")},pauseAllMedia(){if(o&&this.isPlayingExample)try{o.pause(),this.isPlayingExample=!1,this.clearExampleTimer()}catch(e){console.error("暂停示例音频失败:",e)}if(this.videoContext)try{this.videoContext.pause()}catch(e){console.error("暂停视频失败:",e)}},goBack(){this.pauseAllMedia(),e.index.navigateBack()},goNext(){this.pauseAllMedia(),e.index.navigateTo({url:"./step8",fail:()=>{e.index.showToast({title:"恭喜完成所有步骤！",icon:"success",duration:2e3})}})}}};const a=e._export_sfc(i,[["render",function(o,l,i,a,t,s){return{a:e.t(t.isPlayingExample?"❚❚":"▶"),b:e.o(((...e)=>s.togglePlayExample&&s.togglePlayExample(...e))),c:e.t(t.exampleTimeText),d:t.exampleProgress,e:e.o(((...e)=>s.onExampleSliderChange&&s.onExampleSliderChange(...e))),f:e.o(((...e)=>s.onVideoPlay&&s.onVideoPlay(...e))),g:e.o(((...e)=>s.onVideoPause&&s.onVideoPause(...e))),h:e.o(((...e)=>s.onVideoEnd&&s.onVideoEnd(...e))),i:e.o(((...e)=>s.goBack&&s.goBack(...e))),j:e.o(((...e)=>s.goNext&&s.goNext(...e)))}}]]);wx.createPage(a);
