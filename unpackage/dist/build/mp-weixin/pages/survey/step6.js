"use strict";const e=require("../../common/vendor.js");let o=null,r=null;const s={data:()=>({isPlaying:!1,progress:0,currentTimeText:"0:00"}),onLoad(){console.log("Step6页面加载")},onUnload(){this.clearProgressTimer()},methods:{togglePlay(){if(console.log("点击播放按钮，当前状态:",this.isPlaying),this.isPlaying&&o)return console.log("暂停音频"),o.pause(),this.isPlaying=!1,void this.clearProgressTimer();if(o)return console.log("继续播放已存在的音频"),o.play(),this.isPlaying=!0,void this.startProgressTimer();try{console.log("创建新音频实例"),o=e.wx$1.createInnerAudioContext(),o.src="https://tccolumbia.qualtrics.com/CP/File.php?F=F_738nxh0lkZi71vE",o.onError((o=>{console.error("音频播放错误:",o),this.isPlaying=!1,this.clearProgressTimer(),e.index.showToast({title:"音频播放失败",icon:"none"})})),o.onEnded((()=>{console.log("音频播放结束"),this.isPlaying=!1,this.clearProgressTimer(),this.progress=100,this.currentTimeText="8:25"})),o.play(),this.isPlaying=!0,this.startProgressTimer()}catch(r){console.error("音频播放失败:",r),this.isPlaying=!1,e.index.showToast({title:"音频播放失败",icon:"none"})}},startProgressTimer(){this.clearProgressTimer(),r=setInterval((()=>{if(o&&"number"==typeof o.currentTime){const e=o.currentTime;this.progress=Math.floor(e/505*100);const r=Math.floor(e/60),s=Math.floor(e%60);this.currentTimeText=`${r}:${s.toString().padStart(2,"0")}`,console.log(`更新进度: ${this.progress}%, 时间: ${this.currentTimeText}`)}}),1e3)},clearProgressTimer(){r&&(clearInterval(r),r=null)},onSliderChange(r){if(o)try{const e=r.detail.value;console.log("滑块值:",e);const s=e/100*505;console.log("跳转到位置:",s,"秒"),o.seek(s);const t=Math.floor(s/60),i=Math.floor(s%60);this.currentTimeText=`${t}:${i.toString().padStart(2,"0")}`,this.isPlaying||(console.log("从新位置开始播放"),o.play(),this.isPlaying=!0,this.startProgressTimer())}catch(s){console.error("跳转播放失败:",s),e.index.showToast({title:"跳转失败",icon:"none"})}else console.log("音频未初始化，无法跳转")},goBack(){if(o&&this.isPlaying)try{o.pause(),this.clearProgressTimer()}catch(r){console.error("暂停音频失败:",r)}e.index.navigateBack()},goNext(){if(o&&this.isPlaying)try{o.pause(),this.clearProgressTimer()}catch(r){console.error("暂停音频失败:",r)}e.index.navigateTo({url:"./step7",fail:()=>{e.index.showToast({title:"恭喜完成所有步骤！",icon:"success",duration:2e3})}})}}};const t=e._export_sfc(s,[["render",function(o,r,s,t,i,n){return{a:e.t(i.isPlaying?"❚❚":"▶"),b:e.o(((...e)=>n.togglePlay&&n.togglePlay(...e))),c:e.t(i.currentTimeText),d:i.progress,e:e.o(((...e)=>n.onSliderChange&&n.onSliderChange(...e))),f:e.o(((...e)=>n.goBack&&n.goBack(...e))),g:e.o(((...e)=>n.goNext&&n.goNext(...e)))}}]]);wx.createPage(t);
